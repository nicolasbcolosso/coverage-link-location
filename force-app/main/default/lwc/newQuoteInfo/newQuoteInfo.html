<template>
  <lightning-card>
    <!-- Action Buttons -->
    <div class="slds-align_absolute-center slds-p-around_medium">
      <button
        class="slds-button slds-button_brand slds-m-left_large"
        onclick={handleSaveNewQuote}
        disabled={loadSpinner}
      >
        Save
      </button>
      <button
        class="slds-button slds-button_neutral slds-m-left_large"
        onclick={handleCancel}
      >
        Back
      </button>
    </div>

    <div class="slds-section">
      <h3 class="slds-section__title">
        <p
          aria-controls="expando-unique-id"
          aria-expanded="false"
          class="slds-button slds-section__title-action"
        >
          <span class="slds-truncate slds-p-left_small" title="Information">
            Quote Information
          </span>
        </p>
      </h3>

      <template lwc:if={isLoading}>
        <div class="exampleHolder">
          <lightning-spinner
            alternative-text="Loading"
            size="medium"
          ></lightning-spinner>
        </div>
      </template>

      <template lwc:elseif={loadSpinner}>
        <div class="exampleHolder">
          <lightning-spinner
            alternative-text="Saving"
            size="medium"
          ></lightning-spinner>
        </div>
      </template>

      <template lwc:else>
        <div class="slds-grid slds-wrap slds-m-horizontal_large">
          <!-- Quote Name -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>Quote Name</span>
              </div>
              <div class="slds-col slds-size_1-of-2 border-bottom">
                <span>
                  <lightning-input
                    onchange={handleFieldChange}
                    name="Name"
                    data-field-name="Name"
                  ></lightning-input>
                </span>
              </div>
            </div>
          </div>

          <!-- Opportunity (Read-only) -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>Opportunity</span>
              </div>
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>
                  <a href={oppUrl} target="_blank">{oppName}</a>
                </span>
              </div>
            </div>
          </div>

          <!-- Is New Property Enabled (Read-only indicator) -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>Location-Based Property</span>
              </div>
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <template lwc:if={isNewPropertyEnabled}>
                  <span class="slds-badge slds-badge_success">Enabled</span>
                </template>
                <template lwc:else>
                  <span class="slds-badge slds-badge_lightest">Disabled</span>
                </template>
              </div>
            </div>
          </div>

          <!-- Rater Type (for Scale opportunities) -->
          <template lwc:if={isScale}>
            <div class="slds-col slds-size_1-of-2 border-bottom">
              <div class="slds-grid slds-wrap">
                <div
                  class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
                >
                  <span>Rater Type</span>
                </div>
                <div
                  class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
                >
                  <span>{raterType}</span>
                </div>
              </div>
            </div>
          </template>

          <!-- Effective Date -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>Effective Date</span>
              </div>
              <div class="slds-col slds-size_1-of-2 border-bottom">
                <span>
                  <lightning-input
                    type="date"
                    onchange={handleFieldChange}
                    name="Effective_Date__c"
                    data-field-name="Effective_Date__c"
                  ></lightning-input>
                </span>
              </div>
            </div>
          </div>

          <!-- Expiration Date -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>Expiration Date</span>
              </div>
              <div class="slds-col slds-size_1-of-2 border-bottom">
                <span>
                  <lightning-input
                    type="date"
                    onchange={handleFieldChange}
                    name="Expiration_Date__c"
                    data-field-name="Expiration_Date__c"
                  ></lightning-input>
                </span>
              </div>
            </div>
          </div>

          <!-- Premium -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>Premium</span>
              </div>
              <div class="slds-col slds-size_1-of-2 border-bottom">
                <span>
                  <lightning-input
                    type="number"
                    formatter="currency"
                    step="0.01"
                    onchange={handleFieldChange}
                    name="Premium__c"
                    data-field-name="Premium__c"
                  ></lightning-input>
                </span>
              </div>
            </div>
          </div>

          <!-- Policy Fees -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>Policy Fees</span>
              </div>
              <div class="slds-col slds-size_1-of-2 border-bottom">
                <span>
                  <lightning-input
                    type="number"
                    formatter="currency"
                    step="0.01"
                    onchange={handleFieldChange}
                    name="Policy_Fees__c"
                    data-field-name="Policy_Fees__c"
                  ></lightning-input>
                </span>
              </div>
            </div>
          </div>

          <!-- State Tax -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>State Tax</span>
              </div>
              <div class="slds-col slds-size_1-of-2 border-bottom">
                <span>
                  <lightning-input
                    type="number"
                    formatter="currency"
                    step="0.01"
                    onchange={handleFieldChange}
                    name="State_Tax__c"
                    data-field-name="State_Tax__c"
                  ></lightning-input>
                </span>
              </div>
            </div>
          </div>

          <!-- Wholesale Fees -->
          <div class="slds-col slds-size_1-of-2 border-bottom">
            <div class="slds-grid slds-wrap">
              <div
                class="slds-col slds-size_1-of-2 border-bottom slds-p-top_large"
              >
                <span>Wholesale Fees</span>
              </div>
              <div class="slds-col slds-size_1-of-2 border-bottom">
                <span>
                  <lightning-input
                    type="number"
                    formatter="currency"
                    step="0.01"
                    onchange={handleFieldChange}
                    name="Wholesale_Fees__c"
                    data-field-name="Wholesale_Fees__c"
                  ></lightning-input>
                </span>
              </div>
            </div>
          </div>
        </div>
      </template>
    </div>
  </lightning-card>
</template>
